-- migrate:up
CREATE TABLE temp_vulnerability
(
  id UUID PRIMARY KEY,
  date_created TIMESTAMP NOT NULL DEFAULT (strftime('%Y-%m-%dT%H:%M:%fZ','now')),
  name TEXT NOT NULL,
  dependency_id UUID NOT NULL,
  CONSTRAINT fk_dependency_id
    FOREIGN KEY (dependency_id)
    REFERENCES dependency (id)
    ON DELETE CASCADE
);

INSERT INTO temp_vulnerability(id, name, dependency_id) SELECT * FROM vulnerability;

DROP TABLE vulnerability;

ALTER TABLE temp_vulnerability RENAME TO vulnerability;

-- migrate:down
ALTER TABLE vulnerability
DROP date_created;
